<div class="container mt-4 mb-5">
  <div class="row justify-content-center">
    <div class="col-md-9 mb-2">

    <!--ソート機能-->
      <%= link_to '新しい順', admin_posts_path(latest: "true") %>
     |<%= link_to '古い順', admin_posts_path(old: "true") %>
     |<%= link_to '評価の高い順', admin_posts_path(rate: "true") %>
     |<%= link_to 'いいねの多い順', admin_posts_path(favorites_count: "true") %>
    <!--ソート機能ここまで-->

      <% @posts.each do |post| %>
        <div class="mb-3 p-3 border rounded shadow-sm">
          <div class="d-flex align-items-center mb-2">
            <% if post.user %>
              <%= image_tag post.user.get_profile_image(50,50), class: "rounded-circle me-3" %>
            <% else %>
              <%= image_tag 'no_image.jpg', class: "rounded-circle me-3", size: "50x50" %>
            <% end %>
            <h5 class="mb-0"><%= post.comedian_name %></h5>
          </div>
          <p class="mb-2">ネタ：<%= post.title %></p>
          <p class="mb-2"><%= post.body %></p>
          <p><%= render "layouts/star", post: post %></p>
          <div class="d-flex justify-content-start align-items-center text-muted small">
            <span class="me-3">
              <%= post.user.present? ? post.user.name : '未登録ユーザー' %>
            </span>
            <span class="mx-2"> | </span>
            <span>
              <%= "#{post.post_comments.count} コメント" %>
            </span>
            <span class="mx-2"> | </span>
            
          <!--いいね-->
            <% if user_signed_in? && !current_user.guest_user? %>
              <%= link_to post_favorites_path(post), method: :post, remote: true do %>
                <span><%= render "layouts/btn", post: post %></span>
              <% end %>
            <% else %>
              <span>
                <%= render "layouts/btn", post: post %>
              </span>
            <% end %>
          <!--ここまで-->

            <span class="mx-2"> | </span>
            <span>
              <% post.tags.each_with_index do |tag, i| %>
                <%= link_to tag.name, admin_search_path(content: tag.name, model: "tag", method: "perfect") %><%= ',' unless i == post.tags.size - 1 %>
              <% end %>
            </span>
          </div>
          <div class="text-end mt-2">
            <%= link_to '詳細へ', admin_post_path(post.id), class: "btn btn-sm btn-outline-primary" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>